<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# app

```go
import "github.com/Qithub-BOT/QiiTrans/src/app"
```

Package app は、engines\, cache\, utils などのパッケージを組み合わせてアプリを構成するパッケージです\.

QiiTrans の本体でもありますが、main ではアプリのインスタンスの作成と実行だけで済むことで、テストを行いやすいように別のパッケージにしています\.

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func GetMsgHelpUsage(nameApp string, nameCmd string) string](<#func-getmsghelpusage>)
- [type TApp](<#type-tapp>)
  - [func New(cacheID ...string) *TApp](<#func-new>)
  - [func (a *TApp) CliRun(ctx *cli.Context) error](<#func-tapp-clirun>)
  - [func (a *TApp) GetUniformedInfo() (string, error)](<#func-tapp-getuniformedinfo>)
  - [func (a *TApp) GetVersion() string](<#func-tapp-getversion>)
  - [func (a *TApp) NewEngine(nameEngine string, cacheID ...string) (*engine.Properties, error)](<#func-tapp-newengine>)
  - [func (a *TApp) PreRun() error](<#func-tapp-prerun>)
  - [func (a *TApp) Run() int](<#func-tapp-run>)
  - [func (a *TApp) SetArgValue(ctx *cli.Context) error](<#func-tapp-setargvalue>)
  - [func (a *TApp) SetEngine(nameEngine string) (err error)](<#func-tapp-setengine>)
  - [func (a *TApp) Translate(orderLang []string, inputText string) (string, error)](<#func-tapp-translate>)
- [type TFlagOptions](<#type-tflagoptions>)
  - [func (argv *TFlagOptions) AutoHelp() bool](<#func-tflagoptions-autohelp>)
  - [func (argv *TFlagOptions) SetHelpMsg()](<#func-tflagoptions-sethelpmsg>)
  - [func (argv *TFlagOptions) Validate(ctx *cli.Context) error](<#func-tflagoptions-validate>)


## Constants

```go
const (
    // NameDefault は、アプリの公式名称です.
    NameDefault = "QiiTrans"

    // VersionDefault はアプリのバイナリをビルドする際にバージョン指定がない場合のアプリのバージョンです.
    VersionDefault = "dev"
)
```

## Variables

ForceErrorGetUniformedInfo が true の場合、GetUniformedInfo はエラーを返します\.

テスト時に強制的にエラーを返す必要がある場合のみ利用します\.

```go
var ForceErrorGetUniformedInfo = false
```

ForceFailPreRun は PreRun メソッドを強制的に失敗させる（1 を返す）ためのフラグです\. 主にテスト目的で使われます\.

```go
var ForceFailPreRun = false
```

ForceFailRun は Run メソッドを強制的に失敗させる（1 を返す）ためのフラグです\. 主にテスト目的で使われます\.

```go
var ForceFailRun bool = false
```

## func [GetMsgHelpUsage](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/GetMsgHelpUsage.go#L8>)

```go
func GetMsgHelpUsage(nameApp string, nameCmd string) string
```

GetMsgHelpUsage はヘルプ（使い方）のテンプレートの定数 templateUsage から、name\_app と name\_cmd を置換した結果を返します\.

## type [TApp](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.go#L6-L12>)

TApp はアプリの構造体です\.

```go
type TApp struct {
    Argv    *TFlagOptions      // 現在保持しているフラグやオプションの値
    Engine  *engine.Properties // 翻訳に使うエンジン
    Name    string             // アプリの公式名称（ヘルプの表示で使われます）
    Version string             // アプリのバージョン
    // contains filtered or unexported fields
}
```

### func [New](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/New.go#L7>)

```go
func New(cacheID ...string) *TApp
```

New はアプリの新規オプジェクトのポインタを返します\.

コマンド・オプションの \-\-cache\-id でも指定できるため、通常 cacheID は指定する必要はありません\. テスト中、キャッシュがテスト間でバッティングしないようにキャッシュ ID を指定したい場合に利用します\.

### func \(\*TApp\) [CliRun](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.CliRun.go#L11>)

```go
func (a *TApp) CliRun(ctx *cli.Context) error
```

CliRun は app\.Run\(\) の本体で、cli\.Run で呼び出されるメソッドです\.

### func \(\*TApp\) [GetUniformedInfo](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.GetUniformedInfo.go#L16>)

```go
func (a *TApp) GetUniformedInfo() (string, error)
```

GetUniformedInfo は API 情報を読みやすいように整えた状態で返します\.

### func \(\*TApp\) [GetVersion](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.GetVersion.go#L12>)

```go
func (a *TApp) GetVersion() string
```

GetVersion メソッドはアプリ名を含めたバージョン情報を返します\.

Version フィールドの値が "v" で始まらない場合は、頭に付け加えます\. Version フィールドの値が、空もしくは "dev" の場合は "dev version" になります\.

### func \(\*TApp\) [NewEngine](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.NewEngine.go#L10>)

```go
func (a *TApp) NewEngine(nameEngine string, cacheID ...string) (*engine.Properties, error)
```

NewEngine メソッドは nameEngine で指定された翻訳エンジンの新規オブジェクト・ポインタを返します\.

### func \(\*TApp\) [PreRun](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.PreRun.go#L15>)

```go
func (a *TApp) PreRun() error
```

PreRun は Run の本体処理を行う前にフラグ、オプションなどの引数のセットなどを行います\.

テスト目的で強制的に失敗させる場合は ForceFailPreRun を true に設定します\.

### func \(\*TApp\) [Run](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.Run.go#L15>)

```go
func (a *TApp) Run() int
```

Run メソッドはアプリを実行します\. 実行に成功した場合は nil を、失敗した場合は error を返します\.

テスト目的で強制的に失敗させる場合は ForceFail を true に設定します\.

### func \(\*TApp\) [SetArgValue](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.SetArgValue.go#L9>)

```go
func (a *TApp) SetArgValue(ctx *cli.Context) error
```

SetArgValue は cli\.Run 内で渡されるコンテキストからフラグやオプションの値をセットします\.

### func \(\*TApp\) [SetEngine](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.SetEngine.go#L4>)

```go
func (a *TApp) SetEngine(nameEngine string) (err error)
```

SetEngine メソッドは Engine フィールドに翻訳エンジンの新規インスタンスのポインタをセットします\.

### func \(\*TApp\) [Translate](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TApp.Translate.go#L8>)

```go
func (a *TApp) Translate(orderLang []string, inputText string) (string, error)
```

Translate は、orderLang の順に inputText を翻訳した結果を返します\.

## type [TFlagOptions](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TFlagOptions.go#L5-L16>)

TFlagOptions はアプリ（コマンド）のフラグやオプションの設定やその設定値およびヘルプの表示内容を定義した構造体です\. アプリの bool オプション（フラグ）や string オプションなどは、ここで定義します\.

```go
type TFlagOptions struct {
    APIKey         string `cli:"a,apikey" usage:"翻訳に使うエンジンのアクセス・トークンを指定します" dft:""`
    CacheID        string `cli:"cache-id" usage:"キャッシュの DB 名。異なる DB にキャッシュを保存したい場合に指定します" dft:""`
    NameEngine     string `cli:"e,engine" usage:"翻訳に使うエンジンを指定します" dft:"deepl"`
    UsageApp       string // アプリのヘルプ表示で使われる本文メッセージ
    ClearBeforeRun bool   `cli:"clear" usage:"実行前にキャッシュを完全に削除します。（API の利用枠を消費します）"`
    Help           bool   `cli:"h,help" usage:"ヘルプを表示します"`
    IsModeDebug    bool   `cli:"debug" usage:"デバッグ情報を標準エラー出力に出力します"`
    IsNoCache      bool   `cli:"no-cache" usage:"キャッシュを利用せずに翻訳 API から再取得します。（API の利用枠を消費します）"`
    ShowInfo       bool   `cli:"info" usage:"API のリクエスト可能な残数など、API 情報を最後に出力します"`
    Version        bool   `cli:"v,version" usage:"アプリのバージョン情報を表示します"`
}
```

### func \(\*TFlagOptions\) [AutoHelp](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TFlagOptions.AutoHelp.go#L10>)

```go
func (argv *TFlagOptions) AutoHelp() bool
```

AutoHelp は cli\.AutoHelper インターフェースの実装です\.

この関数は cli\.Run\(\) から呼び出され、AutoHelp\(\) が true を返した場合は cli\.Run\(\) は argv のオプションのヘルプを表示します\.

### func \(\*TFlagOptions\) [SetHelpMsg](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TFlagOptions.SetHelpMsg.go#L6>)

```go
func (argv *TFlagOptions) SetHelpMsg()
```

SetHelpMsg はヘルプのテンプレートに現在のアプリ名及び実行ファイル名を流し込みセットします\.

### func \(\*TFlagOptions\) [Validate](<https://github.com/Qithub-BOT/QiiTrans/blob/main/src/app/TFlagOptions.Validate.go#L12>)

```go
func (argv *TFlagOptions) Validate(ctx *cli.Context) error
```

Validate メソッドは、cli\.Validator インターフェースの実装です\.

コマンドのフラグ、オプションや引数のバリデーションを行います。 cli\.Run\(\) で指定された関数が実行される前に呼び出されます\.



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
